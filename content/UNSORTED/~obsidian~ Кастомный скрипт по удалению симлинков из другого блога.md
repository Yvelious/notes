
### Терминология
**Исходные блокноты**
это блокноты в которых находятся исходные статьи.

**Публичный блокнот**
это блокнот, который содержит в себе определенные статьи либо ссылка на них из исходных блокнотов, которые в последствии будут в публичном доступе.



### Notes
Cкрипт для того что бы из публичного блокнота удалить статьи либо симлинки на них, которые мы не хотим показывать в публичном доступе. Если мы не хотим что бы статья была в публичном доступе, тогда надо в исходной заметке сначала удалить тег `symlink`. После этого надо запустить данный скрипт, который удалить статьи из публичного блокнота.


```bash
#!/bin/bash

SEARCH_DIR="$1"
BLOG="$2"

# Function for remove pictures related with notes
process_article() {
    local article_path="$1"
    local blog_dir="$2"

    grep -oE '!\[\[([a-zA-Z0-9 ]+\.(pdf|jpg|png|gif))( \| [0-9]+)?\]\]' "$article_path" | while read -r image_path; do
        image_filename=$(echo "$image_path" | grep -oE '[a-zA-Z0-9 ]+\.(pdf|jpg|png|gif)')

        # Remove pictures from blog
        find "$blog_dir" -name "$image_filename" -exec rm -rf {} \;
    done
}

# General loop for symlink
find "$BLOG" -type l -name "*.md" | while read -r link; do
    article_name=$(basename "$link")
	article_path=$(find "$SEARCH_DIR" -type f -name "$article_name" 2>/dev/null)

    if [[ -n "$article_path" ]] && ! grep -q "symlink:" "$article_path"; then
        process_article "$article_path" "$BLOG"
        rm "$link"
    fi
done
```

`20-28`
Ищем все симлинки с расширением`*.md` в публичном блоке. В результате у нас будет список из этих файлов состоящие из пути и имени файла. Пробегаем циклом по найденному списку.

`21-22`
Создаем две переменных:
1. `article_name` записываем в переменную имя файла, которое мы вычленили из полного пути
2. `article_path` ищем файл уже в исходном блокноте и если находим то записываем в эту переменную.

`24-27`
Условие  в котором мы проверяем две вещи
1. cуществует ли данный файл   `[[ -n "$article_path" ]]`
2. Проверяем на наличие подстроки `symlink:` эта подстрока и инвертируем результат. Что означает если нет такой подстроки тогда это будет true и идем дальше в тело условия.

В теле условия запускаем функцию `process_article` c двумя аргументами `$article_path` и `$BLOG`
После удаляем симлинку которая прошла условия выше 1 и 2.

Можно сказать что на этой этерации удаляется сама симлинка на статью. 
Вторым этапом с помощью функции `process_article` удаляются картинки связанные со статьей.

`7-17`
Функция `process_article` которая принимает два аргумента
1. `$article_path` путь к статье в исходном блокноте
2. `$BLOG` путь к публичному блоку
Эта функция находит в статье картинки, пробегается циклом по найденным картинкам в статье вычленяет имя из пути картинки. После находит эти картинка в публичном блокноте и удаляет их.


### Links


----
[[~obsidian~ shell commands]]
[[~obsidian~ Кастомный скрипт для добавления симлинков в публичном блокноте]]

### Zero
---
[[00 Obsidian]]